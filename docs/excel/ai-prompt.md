# BorderCollie Excel VBA 甘特圖工具 - AI 開發提示

> 本文件記錄使用 AI 開發 Excel VBA 甘特圖工具的完整對話過程與關鍵決策，供未來參考或重新產製使用。

---

## 📋 原始需求

來源檔案：`doc/excel.md`

```markdown
請比照專案完整需求, 設計 Excel 檔案, 包含以下工作表:

1. 專案人力配置表: 規格資料比照編輯區區的圖表編輯
2. 專案甘特圖表: 透過 VBA, 把專案人力配置表資料, 產生專案甘特圖表
3. 人力甘特圖表: 透過 VBA, 把專案人力配置表資料, 產生人力甘特圖表
```

---

## ❓ AI 釐清問題與用戶回覆

在開始實作前，AI 提出以下釐清問題：

### 1. 「專案人力配置表」的具體格式

**問題**：是否維持純文字編輯器的語法格式？還是轉換為更結構化的 Excel 表格格式？

**回覆**：✅ 轉換成更結構化的 Excel 表單

### 2. 甘特圖的視覺呈現

**問題**：
- 是否需要「今日標記」（紅線）功能？
- 是否需要年/月時間軸標題列？
- 條塊樣式要用顏色填充還是其他格式？

**回覆**：
- 今日標記：如果太麻煩可以不需要
- 時間軸：✅ 需要年/月時間軸
- 條塊樣式：✅ 用顏色填充

### 3. 人力甘特圖的負載計算

**問題**：
- 是否需要顯示每月負載數值和紅/綠警示燈號？
- 過載閾值是多少？

**回覆**：✅ 保持紅綠警示燈號，閾值 > 1.1

### 4. VBA 功能範圍

**問題**：VBA 是「手動執行」還是「自動更新」？

**回覆**：✅ 自動更新

### 5. 匯出/匯入

**問題**：是否需要支援與 BorderCollie 網頁版的雙向資料同步？

**回覆**：✅ 請支援雙向匯入/匯出

### 6. Excel 版本相容性

**問題**：目標 Excel 版本？

**回覆**：Excel 2016+

---

## 🏗️ 最終設計決策

### Config 表格結構

| 欄 | 欄位名稱 | 說明 |
|----|----------|------|
| A | 專案名稱 | 專案名稱 |
| B | 擱置 | Y/N 下拉選單 |
| C | 階段 | 階段名稱 |
| D | 開始日期 | YYYY-MM-DD 或 YYYY-MM |
| E | 結束日期 | YYYY-MM-DD 或 YYYY-MM |
| F~U | 人員1~8, 比例1~8 | 最多 8 組人員/比例 |

### 自動更新機制

採用「按鈕觸發 + 工作表切換時更新」方案：
- 開啟檔案時自動更新
- 切換到甘特圖工作表時自動更新
- 提供手動更新按鈕

### VBA 模組架構

```
ModConfig.bas       # 常數與設定
ModDataParser.bas   # 資料解析
ModGanttRenderer.bas # 甘特圖繪製
ModImportExport.bas # 匯入/匯出
ModMain.bas         # 主程式進入點
ThisWorkbook.cls    # 工作簿事件
```

---

## 💡 AI 開發提示 (Prompt)

如需使用 AI 重新開發或改進此工具，可使用以下提示：

```markdown
請為 BorderCollie 專案管理系統開發 Excel VBA 甘特圖工具。

## 背景
BorderCollie 是一個專案管理與人力資源甘特圖工具，使用純文字格式定義專案：

```text
專案名稱:
- 階段名, 開始日期, 結束日期: 人員1 比例, 人員2 比例
```

## 需求
建立 Excel 檔案 (.xlsm)，包含三個工作表：

### 1. Config (專案人力配置表)
- 結構化表格輸入
- 欄位：專案名稱、擱置(Y/N)、階段、開始日期、結束日期、人員1~8、比例1~8
- 支援日期格式：YYYY-MM-DD 和 YYYY-MM

### 2. ProjectGantt (專案甘特圖)
- 以專案為核心
- 年/月時間軸標題列
- 彩色條塊顯示階段
- Pending 專案不顯示

### 3. PersonGantt (人力甘特圖)
- 以人員為核心
- 每月負載計算
- 紅/綠燈號警示 (閾值 > 1.1)

## 技術要求
- Excel 2016+ 相容
- 自動更新：開啟檔案時、切換工作表時
- 雙向匯入/匯出 BorderCollie 純文字格式
- VBA 模組化設計

## 參考資料
- BorderCollie 專案類型定義：src/types/index.ts
- 純文字格式規格：README.md
```

---

## 📁 產出檔案

```
excel/
├── README.md                 # 使用說明
└── vba/
    ├── ModConfig.bas         # 常數與設定
    ├── ModDataParser.bas     # 資料解析
    ├── ModGanttRenderer.bas  # 甘特圖繪製
    ├── ModImportExport.bas   # 匯入/匯出
    ├── ModMain.bas           # 主程式
    └── ThisWorkbook.cls      # 工作簿事件

doc/ai/
├── implement-plan-excel.md   # 詳細實作計畫
└── prompt-excel.md           # 本文件
```

---

## 🔧 後續改進方向

1. **今日標記**：新增紅色垂直線標記當日位置
2. **條件格式**：使用 Excel 條件格式取代 VBA 繪製，提升效能
3. **UserForm**：建立專用表單介面進行匯入/匯出
4. **圖表美化**：加入漸層、陰影等視覺效果
5. **Undo 功能**：支援復原操作
6. **多語言**：支援中英文介面切換

---

## 📅 開發紀錄

- **日期**：2024-12-31
- **AI 模型**：Claude (Anthropic)
- **開發時間**：約 30 分鐘對話 + 程式碼產生
- **程式碼行數**：約 800+ 行 VBA
